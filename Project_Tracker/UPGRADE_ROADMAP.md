# Project Tracker 系統升級優化路線圖

**版本**: v7.0 規劃
**當前版本**: v6.9
**規劃日期**: 2025-12-14

---

## 🎯 已完成項目

### ✅ Phase 0: Task ID 格式升級 (已完成)
- [x] 實作結構化 Task ID (`DEPT-YEAR-MONTH-SEQUENCE`)
- [x] 後端自動生成邏輯
- [x] 前端整合與重新載入機制
- [x] 新舊格式共存

---

## 📋 待實施項目

### 🔧 Phase 1: 系統管理介面 (P0 - 高優先)

#### 1.1 主資料管理 CRUD 介面

**目標**: 讓使用者可以自行管理下拉選單選項，不需修改代碼

##### 需要管理的資料類型

| 資料類型 | 當前狀態 | 新功能 |
|---------|---------|--------|
| **Teams (部門)** | 硬編碼在代碼中 | ✨ 可新增/編輯/刪除 |
| **Projects (專案)** | 硬編碼在代碼中 | ✨ 可新增/編輯/刪除/標記完成 |
| **Owners (負責人)** | 硬編碼在代碼中 | ✨ 可新增/編輯/刪除/停用 |
| **部門代碼 (DEPT_CODES)** | 硬編碼在代碼中 | ✨ 與 Teams 連動管理 |

##### UI 設計規劃

```
┌─────────────────────────────────────────┐
│  🔧 系統設定                             │
├─────────────────────────────────────────┤
│  [Teams] [Projects] [Owners] [Settings] │
├─────────────────────────────────────────┤
│                                          │
│  Teams 管理                              │
│  ┌────────────────────────────────┐     │
│  │ 部門名稱    │ 代碼  │ 操作     │     │
│  ├────────────────────────────────┤     │
│  │ 晶片        │ CHIP  │ ✏️ 🗑️   │     │
│  │ 機構        │ MECH  │ ✏️ 🗑️   │     │
│  │ ...                            │     │
│  │ [+ 新增部門]                    │     │
│  └────────────────────────────────┘     │
└─────────────────────────────────────────┘
```

##### 實作細節

**Google Sheets 架構**：
- 新增工作表：`系統設定_Teams`
- 新增工作表：`系統設定_Projects`
- 新增工作表：`系統設定_Owners`

**前端實作**：
- 新增設定頁面組件 `SettingsView`
- CRUD 操作 UI
- 表單驗證（避免重複、空值）

**後端實作**：
- 新增 Apps Script 函數：
  - `getTeams()` / `addTeam()` / `updateTeam()` / `deleteTeam()`
  - `getProjects()` / `addProject()` / `updateProject()` / `deleteProject()`
  - `getOwners()` / `addOwner()` / `updateOwner()` / `deleteOwner()`

**工作量估計**: 3-5 天

---

### 🔐 Phase 2: Google OAuth 整合 (P1 - 高優先)

#### 2.1 身份驗證

**目標**: 使用 Google 帳號登入，識別使用者身份

**功能**：
- Google OAuth 2.0 登入
- 取得使用者資訊 (email, name, photo)
- 維持登入狀態 (session)

**UI 變更**：
```
未登入: [🔐 使用 Google 登入]

已登入: [👤 James Lu ▼]
       └─ 我的任務
          設定
          登出
```

**實作方式**：
```html
<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client"></script>
```

```javascript
// 登入處理
function handleCredentialResponse(response) {
    const userInfo = parseJwt(response.credential);
    setCurrentUser(userInfo);
}
```

**工作量估計**: 2-3 天

---

#### 2.2 權限管理與角色控制

**目標**: 根據使用者身份控制操作權限

##### 角色定義

| 角色 | 權限 | 說明 |
|------|------|------|
| **Admin** | 全部 | 可管理所有任務、系統設定 |
| **Team Lead** | 部門內全部 | 可管理自己部門的任務 |
| **Member** | 自己的任務 | 只能編輯自己負責的任務 |
| **Viewer** | 唯讀 | 只能查看，不能編輯 |

##### 權限檢查

**新增任務**：
- Admin / Team Lead: 可新增任何部門
- Member: 只能新增自己部門，Owner 自動設為自己

**編輯任務**：
- Admin: 可編輯任何任務
- Team Lead: 可編輯自己部門的任務
- Member: 只能編輯 Owner 是自己的任務

**刪除任務**：
- Admin: 可刪除任何任務
- Team Lead: 可刪除自己部門的任務
- Member: 不能刪除

**實作細節**：

Google Sheets 新增：
- 工作表：`系統設定_使用者角色`

| Email | Name | Role | Department |
|-------|------|------|------------|
| james@company.com | James | Admin | - |
| john@company.com | John | Team Lead | 晶片 |
| mary@company.com | Mary | Member | QA |

**工作量估計**: 3-4 天

---

### 📊 Phase 3: 資料遷移工具 (P1 - 高優先)

#### 3.1 舊 Task ID 遷移

**目標**: 將現有時間戳 ID 遷移為新格式

**策略**：
```
舊 ID: 1765522059996
├─ 依據 Team 確定部門代碼
├─ 依據 Issue_Date 確定年月
├─ 依據序號管理生成序號
└─ 生成新 ID: MECH-2025-12-0005
```

**保存舊 ID**：
- 舊 ID 移到 `Legacy_ID` 欄位
- 新 ID 寫入 `ID` 欄位

**UI 設計**：
```
┌───────────────────────────────────┐
│  🔄 資料遷移                      │
├───────────────────────────────────┤
│  共 45 筆任務需要遷移               │
│                                   │
│  預覽:                             │
│  1765522059996 → MECH-2025-12-0001│
│  1765523059123 → QA-2025-12-0001  │
│  ...                              │
│                                   │
│  ⚠️ 此操作不可逆，請確認備份        │
│                                   │
│  [取消] [確認遷移]                 │
└───────────────────────────────────┘
```

**實作步驟**：
1. 備份現有資料（自動）
2. 掃描所有舊格式 ID
3. 批次生成新 ID
4. 更新資料庫
5. 驗證結果

**Apps Script 函數**：
```javascript
function migrateTaskIds() {
    // 1. 備份
    // 2. 取得所有任務
    // 3. 逐一遷移
    // 4. 更新
}
```

**工作量估計**: 2-3 天

---

### 🎨 Phase 4: UI/UX 增強 (P2 - 中優先)

#### 4.1 任務優先級視覺化

**目標**: 更直觀的優先級顯示

**現狀**: 文字標籤 "High" / "Medium" / "Low"

**改進**：
```
High    → 🔴 緊急    (紅色粗體)
Medium  → 🟡 一般    (黃色)
Low     → 🟢 低      (綠色)
```

**工作量**: 1 天

---

#### 4.2 新 Task ID 優化顯示

**目標**: 利用新格式提升可讀性

**範例**：
```
當前: #MECH-2025-12-0001

改進: [機構] MECH-2025-12-0001
      └─ 顏色標籤對應部門
```

**部門顏色方案**：
- CHIP (晶片): 藍色 #3b82f6
- MECH (機構): 紫色 #8b5cf6
- QA: 靛藍 #6366f1
- ...

**工作量**: 1-2 天

---

#### 4.3 任務快速操作

**目標**: 減少點擊次數

**新增功能**：
- 右鍵選單：編輯 / 刪除 / 複製 ID
- 快速標記完成（雙擊狀態）
- 批次操作（多選 + 批次更新狀態）

**工作量**: 2-3 天

---

### 📈 Phase 5: 報表與統計 (P2 - 中優先)

#### 5.1 部門工作量統計

**利用新 Task ID**：

```
┌─────────────────────────────────┐
│  📊 12月部門工作量統計           │
├─────────────────────────────────┤
│  MECH (機構)  ████████  35 tasks│
│  CHIP (晶片)  ██████    28 tasks│
│  QA           ████      18 tasks│
│  SW (軟體)    ███       12 tasks│
└─────────────────────────────────┘
```

**工作量**: 2 天

---

#### 5.2 月度趨勢分析

**依據 Task ID 的年月**：

```
任務趨勢圖
  60│         ●
  50│       ●   ●
  40│     ●       
  30│   ●
  20│ ●
    └───────────────
     9   10  11  12  1
```

**工作量**: 2-3 天

---

### 🚀 Phase 6: 效能優化 (P2 - 中優先)

#### 6.1 前端快取機制

**目標**: 減少不必要的 API 請求

**實作**：
- IndexedDB 本地快取
- 差異更新機制
- 資料版本控制

**工作量**: 3 天

---

#### 6.2 虛擬滾動

**目標**: 處理大量任務時的效能

**觸發條件**: 任務數 > 100

**工作量**: 2 天

---

### 🔔 Phase 7: 通知系統 (P3 - 低優先)

#### 7.1 任務提醒

**功能**：
- 到期提醒（前 3 天、前 1 天、當天）
- 延遲警告
- 依賴任務完成通知

**實作方式**：
- Apps Script 時間驅動觸發器
- Email 通知
- 可選 Slack / Teams 整合

**工作量**: 3-4 天

---

### 🔗 Phase 8: 外部整合 (P3 - 低優先)

#### 8.1 GitHub Issues 同步

**功能**：
- 雙向同步
- Issue → Task
- Task → Issue

**工作量**: 5-7 天

---

#### 8.2 Slack 整合

**功能**：
- 任務更新通知到 Slack
- Slack 指令快速新增任務
- 每日摘要訊息

**工作量**: 3-4 天

---

## 📅 實施時間表

### 短期 (1-2 週)

**優先順序 P0-P1**：
1. ✅ Task ID 升級 (已完成)
2. 🔧 系統管理介面
3. 🔐 Google OAuth 基礎
4. 📊 舊資料遷移工具

### 中期 (3-4 週)

**優先順序 P1-P2**：
5. 🔐 權限管理
6. 🎨 UI/UX 增強
7. 📈 報表統計

### 長期 (1-2 月)

**優先順序 P2-P3**：
8. 🚀 效能優化
9. 🔔 通知系統
10. 🔗 外部整合

---

## 🎯 下一步建議

### 立即可開始

**推薦順序**：

#### 選項 A：先做管理介面 (推薦)
**理由**：
- 最實用
- 降低維護成本
- 為權限管理打基礎

**開始**：Phase 1.1 - Teams/Projects/Owners CRUD

#### 選項 B：先做 OAuth + 權限
**理由**：
- 安全性提升
- 多人協作準備
- 審計追蹤

**開始**：Phase 2.1 - Google OAuth

#### 選項 C：先做資料遷移
**理由**：
- 統一 ID 格式
- 更好管理
- 充分發揮新 ID 優勢

**開始**：Phase 3.1 - Task ID 遷移

---

## 💡 技術考量

### 架構調整

**建議架構**：
```
前端 (index.html)
  ├─ 組件模組化 (考慮 React 單檔拆分)
  ├─ 狀態管理 (考慮 Context API)
  └─ API 層抽象

後端 (Apps Script)
  ├─ 路由層
  ├─ 服務層
  ├─ 資料存取層
  └─ 工具函數層
```

### 測試策略

**需要新增**：
- 單元測試框架
- 整合測試
- E2E 測試（Playwright）

---

## 📊 預估工作量總計

| Phase | 項目 | 工作量 |
|-------|------|--------|
| 1 | 系統管理介面 | 3-5 天 |
| 2 | OAuth + 權限 | 5-7 天 |
| 3 | 資料遷移 | 2-3 天 |
| 4 | UI/UX 增強 | 4-6 天 |
| 5 | 報表統計 | 4-5 天 |
| 6 | 效能優化 | 5 天 |
| 7 | 通知系統 | 3-4 天 |
| 8 | 外部整合 | 8-11 天 |
| **總計** | | **34-46 天** |

---

## ❓ 需要決定

請告訴我您想優先實施哪個 Phase？

1. **系統管理介面** - 最實用，立即降低維護成本
2. **Google OAuth + 權限** - 安全性，多人協作基礎
3. **資料遷移** - 統一格式，充分利用新 ID
4. **其他** - 您有特別想要的功能？

我會根據您的選擇，立即開始規劃詳細的實施方案！🚀
